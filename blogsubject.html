<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>블로그 포스팅 주제 생성기 V3</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .modal-overlay {
            animation: fadeIn 0.3s ease-in-out;
        }
        .modal-content {
            animation: slideUp 0.3s ease-in-out;
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">
    <div class="w-full max-w-2xl mx-auto bg-white rounded-2xl shadow-lg p-8 md:p-12 relative">
        <header class="text-center mb-6">
            <h1 class="text-3xl font-bold text-gray-800">AI 기반 블로그 주제 생성기</h1>
            <p class="text-gray-500 mt-2">버튼을 클릭하여 전문 분야에 대한 5가지 블로그 포스팅 아이디어를 얻어보세요.</p>
        </header>

        <!-- 설정 버튼 -->
        <button id="settings-btn" class="absolute top-6 right-6 text-gray-400 hover:text-indigo-600 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
        </button>

        <!-- 탭 네비게이션 -->
        <div class="mb-6 border-b border-gray-200">
            <nav class="flex -mb-px space-x-6" aria-label="Tabs">
                <button id="tab-generator" class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-indigo-600 border-indigo-500">
                    주제 생성
                </button>
                <button id="tab-history" class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300 border-transparent">
                    생성 내역
                </button>
            </nav>
        </div>

        <main>
            <!-- 주제 생성기 뷰 -->
            <div id="view-generator">
                <div class="flex justify-center mb-6">
                    <button id="generate-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-lg shadow-md transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50">
                        새로운 주제 5개 생성 ✨
                    </button>
                </div>
                <div id="results-container" class="bg-gray-50 p-6 rounded-lg border border-gray-200 min-h-[280px]">
                    <ol id="results-list" class="space-y-2 text-gray-700">
                        <li class="text-gray-400 p-2">버튼을 눌러 주제 생성을 시작하세요...</li>
                    </ol>
                </div>
                <!-- 프롬프트 결과 뷰 -->
                <div id="prompt-result-container" class="mt-6 hidden">
                    <h3 class="text-lg font-semibold text-gray-800 mb-2">복사된 프롬프트</h3>
                    <div class="relative bg-gray-900 text-white rounded-lg p-4 font-mono text-sm max-h-[300px] overflow-y-auto">
                        <pre id="prompt-output" class="whitespace-pre-wrap break-words"></pre>
                        <button id="copy-btn" class="absolute top-2 right-2 bg-gray-700 hover:bg-gray-600 text-white py-1 px-3 rounded-md text-xs transition-colors">다시 복사</button>
                    </div>
                </div>
            </div>

            <!-- 생성 내역 뷰 -->
            <div id="view-history" class="hidden">
                 <div id="history-container" class="bg-gray-50 p-6 rounded-lg border border-gray-200 min-h-[400px] max-h-[400px] overflow-y-auto">
                    <ul id="history-list" class="space-y-4">
                        <li class="text-gray-400">아직 생성된 내역이 없습니다.</li>
                    </ul>
                </div>
            </div>
        </main>
    </div>

    <!-- 설정 모달 -->
    <div id="settings-modal" class="fixed inset-0 bg-gray-900 bg-opacity-60 flex items-center justify-center p-4 z-50 hidden modal-overlay">
        <div class="bg-white rounded-2xl shadow-xl w-full max-w-lg p-8 modal-content">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">프롬프트 템플릿 설정</h2>
            <p class="text-gray-600 mb-2">프롬프트의 기본 구조를 수정할 수 있습니다.</p>
            <p class="text-xs text-gray-500 mb-6">`{{주제}}`는 선택한 블로그 주제로, `{{데이터}}`는 입력한 참고 자료로 자동 대체됩니다.</p>
            <textarea id="template-input" rows="10" class="w-full border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 transition font-mono text-sm"></textarea>
            <div class="mt-8 flex justify-end space-x-3">
                <button id="settings-modal-close" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-6 rounded-lg transition-colors">취소</button>
                <button id="settings-modal-save" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-colors">저장</button>
            </div>
        </div>
    </div>

    <script>
        const topics = [
    // 부동산 등기
    { category: "부동산 등기", name: "아파트 매매 소유권이전등기" },
    { category: "부동산 등기", name: "토지 매매 소유권이전등기" },
    { category: "부동산 등기", name: "상가 매매 소유권이전등기" },
    { category: "부동산 등기", name: "증여 소유권이전등기" },
    { category: "부동산 등기", name: "부담부증여 소유권이전등기" },
    { category: "부동산 등기", name: "상속 소유권이전등기" },
    { category: "부동산 등기", name: "협의분할에 의한 상속등기" },
    { category: "부동산 등기", name: "법정상속지분 상속등기" },
    { category: "부동산 등기", name: "유증으로 인한 소유권이전등기" },
    { category: "부동산 등기", name: "이혼 재산분할 소유권이전등기" },
    { category: "부동산 등기", name: "공유물분할 소유권이전등기" },
    { category: "부동산 등기", name: "명의신탁해지 소유권이전등기" },
    { category: "부동산 등기", name: "진정명의회복 소유권이전등기" },
    { category: "부동산 등기", name: "소유권보존등기 (신축 건물)" },
    { category: "부동산 등기", name: "미등기부동산 소유권보존등기" },
    { category: "부동산 등기", name: "근저당권 설정등기" },
    { category: "부동산 등기", name: "근저당권 이전등기" },
    { category: "부동산 등기", name: "근저당권 말소등기" },
    { category: "부동산 등기", name: "전세권 설정등기" },
    { category: "부동산 등기", name: "전세권 이전등기" },
    { category: "부동산 등기", name: "전세권 말소등기" },
    { category: "부동산 등기", name: "임차권등기명령 신청" },
    { category: "부동산 등기", name: "주택임차권등기" },
    { category: "부동산 등기", name: "상가임차권등기" },
    { category: "부동산 등기", name: "지상권 설정등기" },
    { category: "부동산 등기", name: "지역권 설정등기" },
    { category: "부동산 등기", name: "소유권이전청구권 가등기" },
    { category: "부동산 등기", name: "담보가등기" },
    { category: "부동산 등기", name: "가등기에 기한 본등기" },
    { category: "부동산 등기", name: "신탁등기 (부동산 담보신탁, 관리신탁)" },
    { category: "부동산 등기", name: "신탁말소등기" },
    { category: "부동산 등기", name: "가압류 및 가처분 말소등기" },
    { category: "부동산 등기", name: "토지거래허가 신청 및 등기" },
    { category: "부동산 등기", name: "농지취득자격증명 발급 및 등기" },
    { category: "부동산 등기", name: "공장재단 및 광업재단 등기" },

    // 법인 등기
    { category: "법인 등기", name: "주식회사 설립등기" },
    { category: "법인 등기", name: "1인법인 설립등기" },
    { category: "법인 등기", name: "유한회사 설립등기" },
    { category: "법인 등기", name: "유한책임회사 설립등기" },
    { category: "법인 등기", name: "대표이사 변경등기" },
    { category: "법인 등기", name: "사내이사 변경등기" },
    { category: "법인 등기", name: "사외이사 변경등기" },
    { category: "법인 등기", name: "감사 변경등기" },
    { category: "법인 등기", name: "대표이사 주소변경등기" },
    { category: "법인 등기", name: "본점이전등기 (관내이전)" },
    { category: "법인 등기", name: "본점이전등기 (관외이전)" },
    { category: "법인 등기", name: "지점설치등기" },
    { category: "법인 등기", name: "지점이전등기" },
    { category: "법인 등기", name: "지점폐지등기" },
    { category: "법인 등기", name: "상호변경등기" },
    { category: "법인 등기", name: "사업목적변경등기" },
    { category: "법인 등기", name: "공고방법변경등기" },
    { category: "법인 등기", name: "유상증자 등기 (제3자배정, 주주배정)" },
    { category: "법인 등기", name: "무상증자 등기" },
    { category: "법인 등기", name: "자본감소(감자) 변경등기" },
    { category: "법인 등기", name: "주식매수선택권(스톡옵션) 부여 등기" },
    { category: "법인 등기", name: "전환사채(CB) 발행등기" },
    { category: "법인 등기", name: "신주인수권부사채(BW) 발행등기" },
    { category: "법인 등기", name: "회사합병 등기" },
    { category: "법인 등기", name: "회사분할 등기" },
    { category: "법인 등기", name: "분할합병 등기" },
    { category: "법인 등기", name: "조직변경 등기" },
    { category: "법인 등기", name: "법인해산 및 청산인 선임 등기" },
    { category: "법인 등기", name: "청산종결 등기" },
    { category: "법인 등기", name: "휴면회사 계속등기" },
    { category: "법인 등기", name: "외국회사 국내영업소 설치등기" },

    // 소송/집행
    { category: "소송/집행", name: "소장 작성 (대여금, 보증금, 공사대금 등)" },
    { category: "소송/집행", name: "답변서 작성" },
    { category: "소송/집행", name: "준비서면 작성" },
    { category: "소송/집행", name: "고소장 및 고발장 작성" },
    { category: "소송/집행", name: "내용증명 작성 및 발송" },
    { category: "소송/집행", name: "지급명령신청 (독촉절차)" },
    { category: "소송/집행", name: "지급명령에 대한 이의신청" },
    { category: "소송/집행", name: "부동산 가압류 신청" },
    { category: "소송/집행", name: "채권 가압류 신청" },
    { category: "소송/집행", name: "유체동산 가압류 신청" },
    { category: "소송/집행", name: "부동산처분금지 가처분 신청" },
    { category: "소송/집행", name: "점유이전금지 가처분 신청" },
    { category: "소송/집행", name: "공사중지 가처분 신청" },
    { category: "소송/집행", name: "부동산 강제경매 신청" },
    { category: "소송/집행", name: "부동산 임의경매 신청" },
    { category: "소송/집행", name: "채권압류 및 추심명령 신청" },
    { category: "소송/집행", name: "채권압류 및 전부명령 신청" },
    { category: "소송/집행", name: "유체동산 강제집행(압류) 신청" },
    { category: "소송/집행", name: "자동차 인도명령 및 강제집행" },
    { category: "소송/집행", name: "재산명시신청" },
    { category: "소송/집행", name: "재산조회신청" },
    { category: "소송/집행", name: "채무불이행자명부등재 신청" },
    { category: "소송/집행", name: "부동산 인도명령 신청" },
    { category: "소송/집행", name: "건물 명도소송 서류작성" },
    { category: "소송/집행", name: "공시최고 및 제권판결 신청" },

    // 회생/파산
    { category: "회생/파산", name: "개인회생 신청" },
    { category: "회생/파산", name: "개인회생 금지명령 및 중지명령 신청" },
    { category: "회생/파산", name: "개인회생 변제계획안 작성 및 수정" },
    { category: "회생/파산", name: "개인파산 신청" },
    { category: "회생/파산", name: "개인파산 면책 신청" },
    { category: "회생/파산", name: "일반회생 신청" },
    { category: "회생/파산", name: "법인회생 신청" },
    { category: "회생/파산", name: "법인파산 신청" },
    { category: "회생/파산", name: "상속재산 파산신청" },

    // 상속/가사
    { category: "상속/가사", name: "상속포기 심판청구" },
    { category: "상속/가사", name: "한정승인 심판청구" },
    { category: "상속/가사", name: "특별한정승인 심판청구" },
    { category: "상속/가사", name: "상속재산분할 심판청구" },
    { category: "상속/가사", name: "기여분 결정 심판청구" },
    { category: "상속/가사", name: "유언증서 검인 청구" },
    { category: "상속/가사", name: "유류분 반환 청구 서류작성" },
    { category: "상속/가사", name: "성년후견 개시 심판청구" },
    { category: "상속/가사", name: "한정후견 개시 심판청구" },
    { category: "상속/가사", name: "특정후견 개시 심판청구" },
    { category: "상속/가사", name: "임의후견계약 공증 및 감독인 선임" },
    { category: "상속/가사", name: "실종선고 심판청구" },
    { category: "상속/가사", name: "부재자재산관리인 선임 청구" },
    { category: "상속/가사", name: "개명허가 신청" },
    { category: "상속/가사", name: "가족관계등록부 정정허가 신청" },
    { category: "상속/가사", name: "친양자 입양 심판청구" },
    
    // 공탁
    { category: "공탁", name: "변제공탁" },
    { category: "공탁", name: "수용보상금 공탁" },
    { category: "공탁", name: "재판상 보증공탁" },
    { category: "공탁", name: "가압류 해방공탁" },
    { category: "공탁", name: "집행공탁" },
    { category: "공탁", name: "혼합공탁" },
    { category: "공탁", name: "공탁금 출급 및 회수 청구" },

    // 행정/기타
    { category: "행정/기타", name: "비영리 사단법인 설립 허가 및 등기" },
    { category: "행정/기타", name: "비영리 재단법인 설립 허가 및 등기" },
    { category: "행정/기타", name: "사회적협동조합 설립 인가 및 등기" },
    { category: "행정/기타", name: "행정심판 청구서 작성 (영업정지, 과징금 등)" },
    { category: "행정/기타", name: "집행정지 신청서 작성" },
    { category: "행정/기타", name: "토지수용 이의신청 및 수용재결신청" },
    { category: "행정/기타", name: "매매계약서, 합의서 등 각종 서류작성 및 검토" },
    { category: "행정/기타", name: "정보공개청구" },

    // 각종 손해배상
    { category: "각종 손해배상", name: "교통사고 손해배상 청구" },
    { category: "각종 손해배상", name: "의료사고 손해배상 청구" },
    { category: "각종 손해배상", name: "산업재해 손해배상 청구" },
    { category: "각종 손해배상", name: "하자보수 손해배상 청구 (누수, 균열 등)" },
    { category: "각종 손해배상", name: "공사대금 청구 소송 서류작성" },
    { category: "각종 손해배상", name: "일조권, 조망권, 사생활 침해 손해배상 청구" },
    { category: "각종 손해배상", name: "층간소음 손해배상 청구" },
    { category: "각종 손해배상", name: "명예훼손 손해배상 청구 (온라인 포함)" },
    { category: "각종 손해배상", name: "폭행, 상해로 인한 손해배상 청구" },
    { category: "각종 손해배상", name: "학교폭력 관련 손해배상 청구" },
    { category: "각종 손해배상", name: "임대차보증금 반환 청구 소송 서류작성" },
    { category: "각종 손해배상", name: "권리금 회수 방해로 인한 손해배상 청구" },
    { category: "각종 손해배상", name: "계약불이행으로 인한 손해배상 청구" },
    { category: "각종 손해배상", name: "물품대금 청구 소송 서류작성" },
    { category: "각종 손해배상", name: "사기, 횡령 등 재산범죄 피해 회복 손해배상" },
    { category: "각종 손해배상", name: "저작권, 상표권 등 지식재산권 침해 손해배상" },

    // 소송/집행 (추가)
    { category: "소송/집행", name: "사해행위취소 소송 서류작성" },
    { category: "소송/집행", name: "배당이의의 소 서류작성" },
    { category: "소송/집행", name: "청구이의의 소 서류작성" },
    { category: "소송/집행", name: "제3자이의의 소 서류작성" },
    { category: "소송/집행", name: "공유물분할 청구 소송 서류작성" },
    { category: "소송/집행", name: "임금 및 퇴직금 청구 소송 서류작성" },

    // 상속/가사 (추가)
    { category: "상속/가사", name: "상속회복청구의 소 서류작성" },
    { category: "상속/가사", name: "유언무효확인의 소 서류작성" },
    { category: "상속/가사", name: "재판상 이혼 청구 서류작성" },
    { category: "상속/가사", name: "이혼에 따른 위자료 청구" },
    { category: "상속/가사", name: "양육비 청구 및 변경 신청" },
    { category: "상속/가사", name: "면접교섭권 이행명령 신청" },
    { category: "상속/가사", name: "약혼해제로 인한 손해배상 청구" },
    { category: "상속/가사", name: "인지청구의 소 서류작성" },
    { category: "상속/가사", name: "친생자관계부존재확인의 소 서류작성" },

    // 행정/기타 (추가)
    { category: "행정/기타", name: "국가배상 신청 및 소송 서류작성" },
    { category: "행정/기타", name: "범죄피해자 구조금 지급신청" },
    { category: "행정/기타", name: "형사소송 배상명령신청" },
    { category: "행정/기타", name: "자동차손해배상보장법에 따른 정부보장사업 청구" },
    { category: "행정/기타", name: "영업정지처분 취소소송 서류작성" },
    { category: "행정/기타", name: "과징금부과처분 취소소송 서류작성" },
    { category: "행정/기타", name: "운전면허 취소/정지처분 취소 행정심판 및 소송" },
    { category: "행정/기타", name: "산재 불승인처분 취소소송 서류작성" },
    { category: "행정/기타", name: "정보공개거부처분 취소소송 서류작성" }
];



        // 키워드 목록: 카테고리와 이름으로 구조화 (대폭 확장 및 다각화됨)
        const keywords = [
            // 1. 개념 및 필요성 (업무의 본질)
    { category: "개념/필요성", name: "핵심 개념과 법적 효력" },
    { category: "개념/필요성", name: "반드시 해야하는 이유 3가지" },
    { category: "개념/필요성", name: "안했을 때 발생하는 법적 불이익과 과태료" },
    { category: "개념/필요성", name: "관련 핵심 법규 및 최신 개정사항" },
    { category: "개념/필요성", name: "가장 흔하게 오해하는 부분 팩트체크" },
    { category: "개념/필요성", name: "핵심 용어 5분 완벽 정리" },
    
    // 2. 자격 및 준비 (실행의 전제 조건)
    { category: "자격/준비", name: "필요서류 A to Z 완벽 체크리스트" },
    { category: "자격/준비", name: "시작 전 반드시 확인해야 할 필수사항 TOP 5" },
    { category: "자격/준비", name: "신청 자격 및 요건 상세 분석" },
    { category: "자격/준비", name: "정부24, 인터넷등기소 필수 서류 발급 가이드" },
    { category: "자격/준비", name: "공동인증서(구 공인인증서) 준비 및 사용법" },

    // 3. 절차 및 방법 (구체적인 실행 과정)
    { category: "절차/방법", name: "단계별 전체 절차 완벽 가이드 (Step-by-Step)" },
    { category: "절차/방법", name: "셀프(나홀로) 진행 시 이것만은 알고 하자" },
    { category: "절차/방법", name: "온라인(전자) 신청으로 하루 만에 끝내는 법" },
    { category: "절차/방법", name: "신청서 항목별 작성법 및 상세 예시" },
    { category: "절차/방법", name: "상대방이 협조하지 않을 때 진행 방법" },
    { category: "절차/방법", name: "잘못 신청했을 때 수정/취하하는 절차" },

    // 4. 비용 및 기간 (경제적/시간적 자원)
    { category: "비용/기간", name: "총 비용(공과금, 수수료) 완벽 분석 및 계산법" },
    { category: "비용/기간", name: "세금(취득세,등록면허세) 절약 꿀팁 3가지" },
    { category: "비용/기간", name: "총 소요 기간과 단축할 수 있는 노하우" },
    { category: "비용/기간", name: "과태료 폭탄 피하는 법정 기한 총정리" },
    { category: "비용/기간", name: "숨겨진 비용(추가 수수료) 발생 막는 방법" },
    { category: "비용/기간", name: "비용이 부족할 때 정부지원 및 분납 제도 활용법" },
    
    // 5. 위험 및 노하우 (실수 방지와 효율 증대)
    { category: "위험/노하우", name: "가장 자주 하는 실수 TOP 5와 예방법" },
    { category: "위험/노하우", name: "모르면 손해보는 핵심 법적 리스크" },
    { category: "위험/노하우", name: "기각 또는 보정명령 피하는 비법" },
    { category: "위험/노하우", name: "법률 전문가만 아는 숨겨진 꿀팁" },
    { category: "위험/노하우", name: "증거자료가 부족할 때 수집하는 방법" },
    { category: "위험/노하우", name: "골든타임! 놓치면 안되는 최적의 시기" },
    { category: "위험/노하우", name: "서류를 분실했을 때 완벽 대처법" },

    // 6. 관할 및 기관 (업무 처리 장소)
    { category: "관할/기관", name: "내 사건의 관할 법원/등기소/관공서 찾는 법" },
    { category: "관할/기관", name: "온라인 vs 오프라인, 제출 기관 장단점 비교" },
    { category: "관할/기관", name: "방문 전 예약 및 준비사항 완벽 가이드" },
    { category: "관할/기관", name: "담당 공무원과 원활하게 소통하는 노하우" },

    // 7. 결과 및 사후관리 (완료 이후)
    { category: "결과/사후관리", name: "처리결과 확인 및 진행상황 조회 방법" },
    { category: "결과/사후관리", name: "완료 증명서(등기필정보 등)의 중요성과 관리법" },
    { category: "결과/사후관리", name: "결과가 만족스럽지 않을 때 이의신청/항고 절차" },
    { category: "결과/사후관리", name: "완료 후 반드시 해야 할 후속 조치 리스트" },
    { category: "결과/사후관리", name: "발급된 서류의 유효기간과 갱신 방법" },

    // 8. 비교 분석 (선택의 기로)
    { category: "비교 분석", name: "셀프진행 vs 전문가 위임, 비용과 시간 완벽 비교" },
    { category: "비교 분석", name: "상황별 최적의 방법 선택 가이드" },

        ];

        // --- DOM Elements ---
        const generateBtn = document.getElementById('generate-btn');
        const resultsList = document.getElementById('results-list');
        const resultsContainer = document.getElementById('results-container');
        const promptResultContainer = document.getElementById('prompt-result-container');
        const promptOutput = document.getElementById('prompt-output');
        const copyBtn = document.getElementById('copy-btn');
        
        const settingsBtn = document.getElementById('settings-btn');
        const settingsModal = document.getElementById('settings-modal');
        const templateInput = document.getElementById('template-input');
        const settingsModalCloseBtn = document.getElementById('settings-modal-close');
        const settingsModalSaveBtn = document.getElementById('settings-modal-save');
        
        const tabGenerator = document.getElementById('tab-generator');
        const tabHistory = document.getElementById('tab-history');
        const viewGenerator = document.getElementById('view-generator');
        const viewHistory = document.getElementById('view-history');
        const historyList = document.getElementById('history-list');

        // --- State Management ---
        let promptTemplate = '';
        let history = [];

        const DEFAULT_PROMPT_TEMPLATE = `당신은 특정 법률 분야의 전문가 블로거입니다. 다음 주제와 참고 자료를 바탕으로, 독자들이 쉽게 이해하고 실질적인 도움을 얻을 수 있는 전문적인 블로그 포스트를 작성해주세요.

### 주제:
{{주제}}

### 참고 자료:
{{데이터}}

### 작성 가이드라인:
- 서론: 주제의 중요성과 독자들이 얻을 수 있는 가치를 명확히 제시
- 본론: 핵심 개념, 절차, 필요 서류, 주의사항 등을 논리적으로 구성. 복잡한 법률 용어는 쉬운 말로 풀어서 설명.
- 결론: 전체 내용을 요약하고, 독자들이 다음으로 취해야 할 행동을 구체적으로 안내
- 예상 독자: 해당 법률 문제에 처음 직면한 일반인
- 톤앤매너: 신뢰감 있고, 전문적이지만 친절한 어조`;
        
        const PROMPT_TEMPLATE_KEY = 'blogPromptTemplate';
        const HISTORY_KEY = 'blogPromptHistory';

        // --- Functions ---
        
        /**
         * Fisher-Yates (aka Knuth) Shuffle 알고리즘.
         */
        function shuffleArray(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex !== 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        /**
         * 블로그 주제 5개를 생성하는 함수
         */
        function generateAndDisplayTopics() {
            const uniqueTopicCategories = [...new Set(topics.map(t => t.category))];
            const uniqueKeywordCategories = [...new Set(keywords.map(k => k.category))];
            shuffleArray(uniqueTopicCategories);
            shuffleArray(uniqueKeywordCategories);

            const generatedTopics = new Set();
            while (generatedTopics.size < 5) {
                const topicIndex = generatedTopics.size % uniqueTopicCategories.length;
                const keywordIndex = generatedTopics.size % uniqueKeywordCategories.length;
                const selectedTopicCategory = uniqueTopicCategories[topicIndex];
                const selectedKeywordCategory = uniqueKeywordCategories[keywordIndex];
                const topicsInCategory = topics.filter(t => t.category === selectedTopicCategory);
                const keywordsInCategory = keywords.filter(k => k.category === selectedKeywordCategory);
                const randomTopic = topicsInCategory[Math.floor(Math.random() * topicsInCategory.length)];
                const randomKeyword = keywordsInCategory[Math.floor(Math.random() * keywordsInCategory.length)];
                const finalTopic = `${randomTopic.name}: ${randomKeyword.name}`;
                generatedTopics.add(finalTopic);
            }
            displayTopics(Array.from(generatedTopics));
        }
        
        /**
         * 생성된 주제 목록을 화면에 표시
         */
        function displayTopics(topicsArray) {
            resultsList.innerHTML = ''; 
            resultsContainer.classList.remove('fade-in');
            
            setTimeout(() => {
                topicsArray.forEach(topic => {
                    const li = document.createElement('li');
                    li.textContent = topic;
                    li.className = "text-lg p-2 rounded-md cursor-pointer hover:bg-indigo-100 transition-colors";
                    li.addEventListener('click', (event) => handleTopicClick(topic, event.currentTarget));
                    resultsList.appendChild(li);
                });
                resultsContainer.classList.add('fade-in');
            }, 10);
        }

        /**
         * 주제 클릭 시 프롬프트를 생성하고 바로 복사
         */
        function handleTopicClick(topic, element) {
            const data = "여기에 구체적인 참고 자료(판례, 법조문, 통계 등)를 입력하여 프롬프트의 품질을 높이세요."; // 데이터 입력란 대체 문구
            
            // 1. 프롬프트 생성
            let finalPrompt = promptTemplate.replace(/{{주제}}/g, topic);
            finalPrompt = finalPrompt.replace(/{{데이터}}/g, data);


            // 2. 생성된 프롬프트 화면에 표시
            promptOutput.textContent = finalPrompt;
            promptResultContainer.classList.remove('hidden');
            promptResultContainer.classList.add('fade-in');

            // 3. 클립보드에 복사 및 시각적 피드백
            const originalText = element.textContent;
            const originalClasses = element.className;

            copyTextToClipboard(finalPrompt).then(() => {
                element.textContent = '복사 완료!';
                element.className = "text-lg p-2 rounded-md bg-green-100 text-green-800 font-semibold transition-all";
                setTimeout(() => {
                    element.textContent = originalText;
                    element.className = originalClasses;
                }, 2000);
            }).catch(err => {
                console.error('클립보드 복사 실패:', err);
                element.textContent = '복사 실패!';
                element.className = "text-lg p-2 rounded-md bg-red-100 text-red-800 font-semibold transition-all";
                setTimeout(() => {
                    element.textContent = originalText;
                    element.className = originalClasses;
                }, 2000);
            });

            // 4. 생성 내역 저장 및 결과 뷰로 스크롤
            addToHistory(finalPrompt);
        }
        
        /**
         * 모달 열기
         */
        function openModal(modal) {
            modal.classList.remove('hidden');
        }

        /**
         * 모달 닫기
         */
        function closeModal(modal) {
            modal.classList.add('hidden');
        }
        
        /**
         * 텍스트를 클립보드에 복사하는 범용 함수 (Iframe 호환성 강화)
         */
        function copyTextToClipboard(text) {
            return new Promise((resolve, reject) => {
                const textArea = document.createElement("textarea");
                textArea.value = text;
        
                // 화면에 보이지 않게 하고, 스크롤 이동을 방지합니다.
                textArea.style.position = "fixed";
                textArea.style.top = "-9999px";
                textArea.style.left = "-9999px";
        
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
        
                try {
                    // document.execCommand는 오래되었지만 iframe 환경에서 가장 확실한 방법입니다.
                    const successful = document.execCommand('copy');
                    if (successful) {
                        resolve();
                    } else {
                        reject(new Error('Copy command was not successful.'));
                    }
                } catch (err) {
                    reject(err);
                } finally {
                    document.body.removeChild(textArea);
                }
            });
        }
        
        /**
         * '다시 복사' 버튼 로직
         */
        function copyToClipboard() {
            copyTextToClipboard(promptOutput.textContent).then(() => {
                const originalText = copyBtn.textContent;
                copyBtn.textContent = '복사 완료!';
                copyBtn.classList.add('bg-green-600');
                setTimeout(() => {
                    copyBtn.textContent = originalText;
                    copyBtn.classList.remove('bg-green-600');
                }, 2000);
            }).catch(err => {
                console.error('클립보드 복사 실패:', err);
                alert('클립보드 복사에 실패했습니다.');
            });
        }
        
        /**
         * 뷰(탭) 전환
         */
        function switchView(viewToShow) {
            [viewGenerator, viewHistory].forEach(view => view.classList.add('hidden'));
            document.getElementById(viewToShow).classList.remove('hidden');
            
            [tabGenerator, tabHistory].forEach(tab => {
                tab.classList.remove('text-indigo-600', 'border-indigo-500');
                tab.classList.add('text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300', 'border-transparent');
            });
            
            if (viewToShow === 'view-generator') {
                tabGenerator.classList.add('text-indigo-600', 'border-indigo-500');
            } else {
                tabHistory.classList.add('text-indigo-600', 'border-indigo-500');
            }
        }

        /**
         * Local Storage에서 데이터 불러오기
         */
        function loadFromLocalStorage() {
            const savedTemplate = localStorage.getItem(PROMPT_TEMPLATE_KEY);
            promptTemplate = savedTemplate ? savedTemplate : DEFAULT_PROMPT_TEMPLATE;
            templateInput.value = promptTemplate;

            const savedHistory = localStorage.getItem(HISTORY_KEY);
            history = savedHistory ? JSON.parse(savedHistory) : [];
            renderHistory();
        }

        /**
         * 생성 내역에 추가하고 Local Storage에 저장
         */
        function addToHistory(prompt) {
            const timestamp = new Date().toISOString();
            history.unshift({ prompt, timestamp }); 
            if (history.length > 50) { 
                history.pop();
            }
            localStorage.setItem(HISTORY_KEY, JSON.stringify(history));
            renderHistory();
        }
        
        /**
         * 생성 내역 뷰 렌더링
         */
        function renderHistory() {
            historyList.innerHTML = '';
            if (history.length === 0) {
                historyList.innerHTML = '<li class="text-gray-400">아직 생성된 내역이 없습니다.</li>';
                return;
            }

            history.forEach(item => {
                const li = document.createElement('li');
                li.className = 'border border-gray-200 p-4 rounded-lg bg-white';
                
                const date = new Date(item.timestamp);
                const formattedDate = `${date.getFullYear()}.${String(date.getMonth() + 1).padStart(2, '0')}.${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
                
                const historyPrompt = item.prompt.length > 150 ? item.prompt.substring(0, 150) + '...' : item.prompt;

                li.innerHTML = `
                    <p class="text-xs text-gray-500 mb-2">${formattedDate}</p>
                    <pre class="text-sm text-gray-800 whitespace-pre-wrap break-words font-sans">${historyPrompt}</pre>
                    <button class="text-indigo-600 hover:text-indigo-800 text-sm mt-3 font-semibold history-copy-btn">전체 복사</button>
                `;
                li.querySelector('.history-copy-btn').addEventListener('click', (e) => {
                    const button = e.target;
                    copyTextToClipboard(item.prompt).then(() => {
                        const originalText = button.textContent;
                        button.textContent = '복사 완료!';
                        setTimeout(() => { button.textContent = originalText; }, 2000);
                    });
                });
                historyList.appendChild(li);
            });
        }
        
        // --- Event Listeners ---
        generateBtn.addEventListener('click', generateAndDisplayTopics);
        copyBtn.addEventListener('click', copyToClipboard);

        settingsBtn.addEventListener('click', () => {
            templateInput.value = promptTemplate; 
            openModal(settingsModal);
        });
        settingsModalCloseBtn.addEventListener('click', () => closeModal(settingsModal));
        settingsModalSaveBtn.addEventListener('click', () => {
            promptTemplate = templateInput.value;
            localStorage.setItem(PROMPT_TEMPLATE_KEY, promptTemplate);
            closeModal(settingsModal);
        });
        
        tabGenerator.addEventListener('click', () => switchView('view-generator'));
        tabHistory.addEventListener('click', () => switchView('view-history'));

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            loadFromLocalStorage();
            switchView('view-generator');
        });

    </script>
</body>
</html>

